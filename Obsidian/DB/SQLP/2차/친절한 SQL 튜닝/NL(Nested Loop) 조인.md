### 기본 메커니즘

일반적으로 NL 조인은 Outer와 Inner 양쪽 테이블을 모두 인덱스를 이용한다.

- Outer 쪽 테이블의 크기가 작은 경우 인덱스를 사용하지 않을 수 있다.
- NL 조인은 인덱스를 이용한 조인 방식이라고 할 수 있다.

**동작 과정**

1. Inner 쪽 테이블의 인덱스를 스캔한다
2. 인덱스에서 읽은 ROWID를 통해서 테이블 레코드를 찾아간다.
3. 테이블 레코드에서 얻은 조인 컬럼으로 Outer 쪽 테이블의 인덱스를 스캔한다.
4. 인덱스에서 읽은 ROWID로 테이블 레코드를 찾아간다.

### NL 조인 실행계획 제어

실행계획에는 NESTED LOOP 밑으로 Inner 테이블과 사용된 인덱스, Outer 테이블과 사용된 인덱스가 표기된다.

```sql
Execution Plan
--------------------------------------------------
0     SELECT STATEMENT Optimizer=ALL_ROWS
1 0	    NESTED LOOP
2 1       TABLE ACCESS (BY INDEX ROWID) OF 테이블1 (TABLE)
3 2         INDEX (RANGE SCAN) OF 인덱스1 (INDEX)
4 1       TABLE ACCESS (BY INDEX ROWID) OF 테이블2 (TABLE)
5 4         INDEX (RANGE SCAN) OF 인덱스2 (INDEX)
```

NL 조인을 유도할 때는 use_nl 힌트를 사용한다

### NL 조인 튜닝 포인트

- 인덱스에서 검색된 결과가 많고, 테이블 필터 조건에서 걸러지는 것이 많다면, 인덱스에 해당 테이블 필터 조건 컬럼을 추가하는 것도 고려해야한다.
- 조인 액세스의 횟수가 많을수록 성능이 느려지게 되는데, 조인 액세스 횟수는 Outer 테이블을 필터링한 건수에 의해 결정된다.

### NL 조인 특징 요약

- 랜덤 액세스 위주의 조인 방식이다.
    - 레코드 하나를 읽기 위해 블록을 통째로 읽는 랜덤 액세스 방식은 설령 메모리 버퍼에서 빠르게 읽더라도 비효율이 존재한다.
    - 인덱스 구성이 아무리 완벽해도 대량 데이터 조인할 때 NL 조인이 불리한 이유이다.
- 조인을 한 레코드씩 순차적으로 진행한다.
    - 부분 범위 처리를 활용해서 매우 빠른 응답 속도를 낼 수 있다.
    - 순차적으로 액세스하므로 먼저 액세스하는 테이블 처리 범위에 의해 전체 일량이 결정된다.
- 인덱스 구성 전략이 특히 중요하다.
    - 인덱스에 따라 조인 효율이 크게 달라진다.
- OLTP 시스템에 적합한 조인 방식이다.